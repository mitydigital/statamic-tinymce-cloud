var $=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],S=function(n){return $.map(function(e){return e.toLowerCase()}).indexOf(n.toLowerCase())!==-1},w=function(n,e,t){Object.keys(e).filter(S).forEach(function(r){var i=e[r];typeof i=="function"&&(r==="onInit"?i(n,t):t.on(r.substring(2),function(a){return i(a,t)}))})},E=function(n,e){var t=n.$props.modelEvents?n.$props.modelEvents:null,r=Array.isArray(t)?t.join(" "):t;n.$watch("value",function(i,a){e&&typeof i=="string"&&i!==a&&i!==e.getContent({format:n.$props.outputFormat})&&e.setContent(i)}),e.on(r||"change input undo redo",function(){n.$emit("input",e.getContent({format:n.$props.outputFormat}))})},D=function(n,e,t){var r=e.$props.value?e.$props.value:"",i=e.$props.initialValue?e.$props.initialValue:"";t.setContent(r||(e.initialized?e.cache:i)),e.$listeners.input&&E(e,t),w(n,e.$listeners,t),e.initialized=!0},h=0,C=function(n){var e=Date.now(),t=Math.floor(Math.random()*1e9);return h++,n+"_"+t+h+String(e)},O=function(n){return n!==null&&n.tagName.toLowerCase()==="textarea"},y=function(n){return typeof n>"u"||n===""?[]:Array.isArray(n)?n:n.split(" ")},P=function(n,e){return y(n).concat(y(e))},T=function(n){return n==null},g=function(){return{listeners:[],scriptId:C("tiny-script"),scriptLoaded:!1}},I=function(){var n=g(),e=function(i,a,u,d){var o=a.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=i,o.src=u;var s=function(){o.removeEventListener("load",s),d()};o.addEventListener("load",s),a.head&&a.head.appendChild(o)},t=function(i,a,u){n.scriptLoaded?u():(n.listeners.push(u),i.getElementById(n.scriptId)||e(n.scriptId,i,a,function(){n.listeners.forEach(function(d){return d()}),n.scriptLoaded=!0}))},r=function(){n=g()};return{load:t,reinitialize:r}},M=I(),L=function(){return typeof window<"u"?window:global},p=function(){var n=L();return n&&n.tinymce?n.tinymce:null},A={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(n){return n==="html"||n==="text"}}},f=globalThis&&globalThis.__assign||function(){return f=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},f.apply(this,arguments)},R=function(n,e,t){return n(t||"div",{attrs:{id:e}})},z=function(n,e){return n("textarea",{attrs:{id:e},style:{visibility:"hidden"}})},c=function(n){return function(){var e=f(f({},n.$props.init),{readonly:n.$props.disabled,selector:"#"+n.elementId,plugins:P(n.$props.init&&n.$props.init.plugins,n.$props.plugins),toolbar:n.$props.toolbar||n.$props.init&&n.$props.init.toolbar,inline:n.inlineEditor,setup:function(t){n.editor=t,t.on("init",function(r){return D(r,n,t)}),n.$props.init&&typeof n.$props.init.setup=="function"&&n.$props.init.setup(t)}});O(n.element)&&(n.element.style.visibility=""),p().init(e)}},B={props:A,created:function(){this.elementId=this.$props.id||C("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,p()!==null)c(this)();else if(this.element&&this.element.ownerDocument){var n=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",t=T(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+n+"/tinymce.min.js":this.$props.tinymceScriptSrc;M.load(this.element.ownerDocument,t,c(this))}},beforeDestroy:function(){p()!==null&&p().remove(this.editor)},deactivated:function(){var n;this.inlineEditor||(this.cache=this.editor.getContent(),(n=p())===null||n===void 0||n.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&c(this)()},render:function(n){return this.inlineEditor?R(n,this.elementId,this.$props.tagName):z(n,this.elementId)}};function j(n,e,t,r,i,a,u,d){var o=typeof n=="function"?n.options:n;e&&(o.render=e,o.staticRenderFns=t,o._compiled=!0),r&&(o.functional=!0),a&&(o._scopeId="data-v-"+a);var s;if(u?(s=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),i&&i.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(u)},o._ssrRegister=s):i&&(s=d?function(){i.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:i),s)if(o.functional){o._injectStyles=s;var _=o.render;o.render=function(b,m){return s.call(m),_(b,m)}}else{var v=o.beforeCreate;o.beforeCreate=v?[].concat(v,s):[s]}return{exports:n,options:o}}const F={mixins:[Fieldtype],components:{editor:B},computed:{apiKey(){return this.meta.key},cloudChannel(){return this.meta.cloud_channel?this.meta.cloud_channel:6},contentCss(){return"tinymce_cloud_"+Statamic.$slug.create(this.meta.init.toLowerCase())},init(){return typeof tinymceCloudConfig>"u"?(alert("The Tiny Cloud config file could not be found. Make sure you have at least one configuration saved."),{}):typeof tinymceCloudConfig[this.meta.init]>"u"?(alert("Your requested Tiny Cloud config could not be found. Please confirm your Blueprint and Tiny Cloud configurations."),{}):tinymceCloudConfig[this.meta.init]}},data(){return{enabled:!1}},mounted(){this.meta.init_mode!=="defer"&&(this.enabled=!0)}};var U=function(){var r;var e=this,t=e._self._c;return t("div",[e.meta.init_mode==="defer"&&!e.enabled?t("div"):e._e(),e.enabled?t("editor",{attrs:{"api-key":e.apiKey,"cloud-channel":e.cloudChannel,init:e.init,value:e.value},on:{input:e.update}}):t("div",{staticClass:"bg-gray-100 border border-gray-200 rounded overflow-hidden",class:{"mt-4":((r=e.value)==null?void 0:r.trim())!=""}},[t("div",{staticClass:"font-medium text-xs px-4 py-1.5 bg-gray-300 flex items-center justify-between"},[t("div",[e._v(" "+e._s(e.__("statamic-tinymce-cloud::fieldtype.preview",{display:e.config.display}))+" ")]),t("div",{staticClass:"whitespace-nowrap"},[t("button",{staticClass:"btn-primary btn-xs",on:{click:function(i){i.preventDefault(),e.enabled=!0}}},[e._v(" "+e._s(e.__("statamic-tinymce-cloud::fieldtype.enable"))+" ")])])]),e.value?t("div",{class:[e.contentCss]},[t("div",{staticClass:"max-w-full prose prose-sm text-xs px-4 py-3 border-t border-gray-200",domProps:{innerHTML:e._s(e.value)}})]):e._e()])],1)},K=[],V=j(F,U,K,!1,null,null,null,null);const k=V.exports;Statamic.booting(()=>{Statamic.$components.register("tinymce_cloud-fieldtype",k)});
